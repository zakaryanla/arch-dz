# helm upgrade --install crud-api-dz4 C:\Users\zakar\Documents\arch-dz\dz4-dz5\helm\crud-api-dz4
fullnameOverride: "crud-api-dz4"

replicaCount: 5

image:
  repository: zakaryanla/crud-api-dz4
  pullPolicy: Always
  tag: "3.0"

metrics:
  enabled: true
  path: /metrics
  port: "8000"

imagePullSecrets: []

config:
  PGHOST: 'crud-db-postgresql'
  PGPORT: '5432'
  PGDATABASE: crudapi
  GUNICORN_PROCESSES: "3"

secrets:
  PGUSER: crudapi
  PGPASSWORD: a2dvxX32fds

migrate:
  enabled: true
  command: cd db && pgmigrate -t latest migrate

resources:
  limits:
    cpu: "1"
    memory: "512Mi"
  requests:
    cpu: 100m
    memory: "128Mi" 

service:
  type: ClusterIP
  port: 5000

ingress:
  enabled: true
  className: nginx
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: "arch.homework"
      paths:
        - path: /
          pathType: Prefix
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

readinessProbe:
  httpGet:
    path: /api/v1/user/1
    port: 5000
    scheme: HTTP
  initialDelaySeconds: 10
  timeoutSeconds: 10
  periodSeconds: 30
  successThreshold: 2
  failureThreshold: 4
livenessProbe:
  httpGet:
    path: /api/v1/user/1
    port: 5000
    scheme: HTTP
  initialDelaySeconds: 10
  timeoutSeconds: 10
  periodSeconds: 30
  successThreshold: 1
  failureThreshold: 8